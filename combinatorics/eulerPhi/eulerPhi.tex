\documentclass[handout]{ximera}

\input{../preamble}

\pgfplotsset{compat=1.13}

\outcome{Introduce Euler's $phi$ function}

\title{2.5 Euler's $\phi$ Function}

\begin{document}



\begin{abstract}
We present a formula for Euler's $\phi$ function.
\end{abstract}

\maketitle


\begin{definition}[Relatively Prime]
Two natural numbers $m$ and $n$ are called relatively prime if their greatest common divisor is 1, i.e., $gcd(m,n) = 1$
\end{definition}

\begin{example}[example 1]
The numbers 64 and 81 are relatively prime since the only natural number that divides evenly into both is 1, i.e., $gcd(64,81) = 1$.
\end{example}

\begin{problem}(problem 1a)
List all pairs that are relatively prime from among the numbers 12, 14, 15, 25 and 45
\end{problem}

\begin{problem}(problem 1b)
Explain why any two successive natural numbers are relatively prime.
\end{problem}

\begin{problem}(problem 1c)
Explain why any two distinct prime numbers are relatively prime.
\end{problem}

\begin{problem}(problem 1d)
Which natural numbers are relatively prime to themselves?
\end{problem}

\begin{theorem}[Fundamental Theorem of Arithmetic]
Every natural number greater than 1 has a unique prime factorization, i.e., for $n >1$, there exists a 
unique list of distinct primes
$p_1, p_2, ..., p_r$ and a unique list of positive integers $\alpha_1, \alpha_2, ..., \alpha_r$ such that
\[
n = p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_r^{\alpha_r}
\]
\end{theorem}


\begin{example}[example 2]
Find the prime factorization of 2345.\\
Since the number 2345 ends in 5, it must be divisible by 5.  Hence, $2345 = 5 \cdot 469$. Now note that 469 is divisible by 7,
and we have $2345 = 5 \cdot 7 \cdot 47$. Since 47 is prime, this is the unique prime factorization of 2345.
\end{example}

\begin{problem}(problem 2)
Find the prime factorizations of 1000, 1111, and 43125.
\end{problem}



\begin{definition}[Euler's $\phi$ function]
For each natural number $n$, we define Euler's $\phi$ function (sometimes called the totient function) to be the 
number of natural numbers less than $n$ which are relatively prime to $n$.
\end{definition}


\begin{example}[example 3]
Find $\phi(10)$.\\
Among the natural numbers less than 10 the following are relatively prime to 10: 
\[
1, 3, 7 \;\; 
\text{and} \;\; 9
\]

Since there are 4 such numbers, $\phi(10) = 4$.
\end{example}

\begin{problem}(problem 3a)
Find $\phi(4), \phi(6)$ and $\phi(9)$.\\
\[
\phi(4) = \answer{2} \quad \phi(6) = \answer{2} \quad \phi(9) = \answer{6}
\]
\end{problem}

\begin{problem}(problem 3b)
Find a formula $\phi(p)$ for any prime $p$.\\
\begin{multipleChoice}
\choice{$\phi(p) = p$}\\
\choice[correct]{$\phi(p) = p-1$}\\
\choice{$\phi(p) = 1$}
\end{multipleChoice}
\end{problem}


We now state the main proposition of this section, whose proof utilizes the Inclusion-Exclusion Principle.





\begin{proposition}[Formula for Euler's $\phi$ function]
Let $n>1$ be a natural number with prime factorization
$n = p_1^{\alpha_1}p_2^{\alpha_2} \cdots p_r^{\alpha_r}$.  Then
\[
\phi(n) = n \prod_{i = 1}^r \left(1 - \frac{1}{p_i}\right)
\]
\end{proposition}



\begin{proof}
If $m$ is a natural number less than $n$ which is relatively prime to $n$, 
then none of the primes $p_i$ will divide $m$.
For each $i$, define 
$A_i$ to be the subset of $S = \{1, 2, ..., n\}$ consisting of the multiples of the prime $p_i$.
Then
\[
|A_i| = \frac{n}{p_i}, \;\;|A_i \cap A_j| = \frac{n}{p_i p_j}, \;\;|A_i \cap A_j \cap A_k| = \frac{n}{p_i p_jp_k}, \;\;\text{etc.}
\]

Now, we use the Inclusion-Exclusion Principle to compute $\phi(n)$:
\begin{align*}
\phi(n) &= |A_1^c \cap A_2^c \cap \cdots \cap A_r^c|\\
&= |(A_1 \cup A_2 \cup \cdots \cup A_r)^c|\\
&= |S| -  |A_1 \cup A_2 \cup \cdots \cup A_r|\\
&= |S| - \sum|A_i| + \sum|A_i \cap A_j| + \sum|A_i \cap A_j \cap A_k| + \cdots + (-1)^r|A_1 \cap A_2 \cap \cdots \cap A_r|\\[7pt]
&= n - \sum \frac{n}{p_i} + \sum \frac{n}{p_ip_j} - \sum \frac{n}{p_ip_jp_k} + \cdots + (-1)^r \frac{n}{p_1p_2 \cdots p_r}\\[7pt]
&= n\left(1 - \sum \frac{1}{p_i} + \sum \frac{1}{p_ip_j} - \sum \frac{1}{p_ip_jp_k} + \cdots + (-1)^r \frac{1}{p_1p_2 \cdots p_r} \right)\\[7pt]
&= n \prod_{i = 1}^r \left(1 - \frac{1}{p_i}\right)
\end{align*}
\end{proof}

\begin{corollary}
Euler's $\phi$ function is multiplicative, i.e., if $m$ and $n$ are relatively prime, then
\[
\phi(mn) = \phi(m)\phi(n)
\]
\end{corollary}
\begin{proof}
Let the prime factorizations of $m$ and $n$ be
\[
m = p_1^{\alpha_1} p_2^{\alpha_2}\cdots p_r^{\alpha_r} \quad \text{and} \quad n = p_{r+1}^{\alpha_{r+1}} p_{r+2}^{\alpha_{r+2}}\cdots p_s^{\alpha_s}
\]
Since $m$ and $n$ are relatively prime, the prime factorization of $mn$ is given by
\[
mn = p_1^{\alpha_1} p_2^{\alpha_2}\cdots p_s^{\alpha_s}
\]
According to the proposition,
\[
\phi(m) = m \prod_{i = 1}^r \left(1 - \frac{1}{p_i}\right),
\]
\[
\phi(n) = n \prod_{i = r+1}^s \left(1 - \frac{1}{p_i}\right),
\]
and
\[
\phi(mn) = mn \prod_{i = 1}^s \left(1 - \frac{1}{p_i}\right)
\]
It is now clear that $\phi(mn) = \phi(m) \phi(n)$.
\end{proof}

\begin{example}[example 4]
Use the proposition to compute $\phi(12)$ and $\phi(125)$ and then use the corollary to compute $\phi(1500)$.\\
Since $12 = 2^2 3$, the proposition gives
\[
\phi(12) = 12\left(1-\frac12\right)\left(1-\frac13\right) = 4
\]
and since $125 = 5^3$, the proposition gives
\[
\phi(125) = 125\left(1-\frac15\right) = 100
\]
Finally, since $1500 = 12 \cdot 125$, the corollary gives
\[
\phi(1500) = \phi(12)\phi(125) = 400
\]
\end{example}

\begin{problem}(problem 4a)
Use the proposition to compute $\phi(50)$ and $\phi(189)$ and then use the corollary to compute 
$\phi(9450)$.\\
\[
\phi(50) = \answer{20}, \;\; \phi(189) = \answer{108} \;\; \text{and} \;\; \phi(9450)= \answer{2160}
\]
\end{problem}

\begin{problem}(problem 4b)
Use the proposition to establish a formula for $\phi(p^\alpha)$ where $p$ is any prime and $\alpha$ is a positive integer.
\end{problem}


The proof of the proposition uses a factorization theorem. We explore this theorem in the next example and problem.

\begin{example}[example 5]
Multiply
\[
(1-a)(1-b)(1-c)
\]
and use this to validate the factorization in the last step of the proof of the proposition in the case that $n$ has 3 distinct prime factors.\\
The FPC tells us that there will be $2^3 = 8$ terms.  Further, we can group these terms according to how many of the variables $a, b, c$ are present. We have
\[
(1-a)(1-b)(1-c) = 1 - (a+b+c) + (ab+ac+bc) - (abc)
\]
Referring back to the proof of the proposition, suppose $n$ had three distinct prime factors, $p_1, p_2, p_3$.
Then the Inclusion-Exclusion Principle gives
\[
\phi(n) = n\left(1 - \sum \frac{1}{p_i} + \sum \frac{1}{p_ip_j} - \frac{1}{p_1p_2p_3}\right)
\]
If we expand these sums, we obtain 
\[
n\left[1 - \left(\frac{1}{p_1} + \frac{1}{p_2}+\frac{1}{p_3}\right) + \left(\frac{1}{p_1p_2} + \frac{1}{p_1p_3} + \frac{1}{p_2p_3}\right) - \left(\frac{1}{p_1p_2p_3}\right)\right]
\]
Noting that the expression in the brackets has the same form as the expansion of $(1-a)(1-b)(1-c)$ with $a = \frac{1}{p_1},
b= \frac{1}{p_2}$ and $c = \frac{1}{p_3}$, we have
\[
 \phi(n) = n\left(1 - \frac{1}{p_1}\right)\left(1 - \frac{1}{p_2}\right)\left(1 - \frac{1}{p_3}\right) = n \prod_{i = 1}^3\left(1 - \frac{1}{p_i}\right)
 \]
 \end{example}
 
 \begin{problem}(problem 5a)
 Multiply
\[
(1-a)(1-b)(1-c)(1-d)
\]
and use this to validate the factorization in the last step of the proof of the proposition in the case that $n$ has 4 distinct prime factors.
\end{problem}

\begin{problem}(problem 5b)
Conjecture the factorization formula for
\[
1 - (a + b+c+d+e) + (ab+ac+ad+ae+bc+bd+be+cd+ce+de) 
\]
\[
- (abc+abd+abe+acd+ace+ade+bcd+bce+bde+cde) 
\]
\[
- (abcd+abce+abde+acde+bcde) + (abcde)
\]
\end{problem}

\begin{problem}(problem 5c)
Conjecture the factorization formula for
\[
1 - \sum_{i = 1}^n a_i + \sum_{1 = i <j}^n a_ia_j - \sum_{1 = i <j<k}^n a_ia_ja_k + \cdots + (-1)^n (a_1a_2\cdots a_n)
\]
\end{problem}



\end{document}







