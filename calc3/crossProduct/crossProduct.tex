\documentclass[handout]{ximera}

\input{../preamble}

\outcome{In this section we define the cross product and we use it to create orthogonal vectors.}

\title{1.5 The Cross Product}



\begin{document}

\begin{abstract}
In this section we define the cross product and we use it to create orthogonal vectors.
\end{abstract}
 
\maketitle
The cross product is a special operation that helps us to create a vector that is orthogonal to two given vectors in $\R^3$.
\begin{definition}[Cross Product in $\R^3$]
Let $\vec{v}_1$ and $\vec{v}_2$ be vectors in $\R^3$ with components:
\[
\vec{v}_1 = \vector{x_1, y_1, z_1} \text{  and   } \;\vec{v}_2 = \vector{x_2, y_2, z_2}
\]
The \textbf{cross product} is defined by
\[
\vec{v}_1 \cross \vec{v}_2 =  (y_1z_2 - z_1y_2) \vec{i} + (z_1x_2 - x_1z_2) \vec{j} + (x_1y_2 - y_1x_2) \vec{k} 
\]
\end{definition}

The definition of the cross product of two vectors is easier to understand in the context of \textbf{matrix determinants}.

\begin{definition}[Determinant of a $2 \times 2$ Matrix]
The determinant of the $2 \times 2$ matrix 
\[
\begin{bmatrix}
a & b\\
c & d
\end{bmatrix}
\]
is  given by
\[
\begin{vmatrix}
a & b\\
c & d
\end{vmatrix}
= ad-bc
\]
Note that the determinant of a matrix is a number.
\end{definition}

\begin{definition}[Determinant of $3 \times 3$ Matrix]
The determinant of a $3 \times 3$ matrix is given in terms of determinants of $2 \times 2$ sub-matrices:
%\begin{align*}
\[
\begin{vmatrix}
a & b & c\\
d & e & f\\
g & h & i
\end{vmatrix}
= a\begin{vmatrix}
 e & f\\
 h & i
\end{vmatrix}
-b
\begin{vmatrix}

d  & f\\
g  & i
\end{vmatrix}
+c\begin{vmatrix}
d & e \\
g & h 
\end{vmatrix}
\]
\[
= a(ei-fh) - b(di-fg) + c(dh-eg)
\]
Note that the determinant of a matrix is a number. 
Also note that each sub-matrix is obtained from the original matrix by removing the row and column of its coefficient, $a, b$ or $c$. 
\end{definition}

 We can use the definition of the determinant of a $3 \times 3$ matrix to compute the cross product of two 
 vectors by replacing the numbers in the top row with the standard basis vectors.
 
 \begin{proposition}[Cross Product] 
 Let  $\vec{v_1} = \vector{x_1, y_1, z_1}$ and $\vec{v_2} = \vector{x_2, y_2, z_2}$ be vectors in $\R^3$. 
 Then the cross product is given by
 \[
\vec{v_1} \cross \vec{v_2} = 
 \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
x_1 & y_1 & z_1\\
x_2 & y_2 & z_2
\end{vmatrix} 
\]

\end{proposition}


\begin{proof}
\[
 \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
x_1 & y_1 & z_1\\
x_2 & y_2 & z_2
\end{vmatrix} 
= \begin{vmatrix}
 y_1 & z_1  \\
 y_2 & z_2 \\
 \end{vmatrix} \cdot \vec i
 - \begin{vmatrix}
 x_1 & z_1  \\
 x_2 & z_2 \\
 \end{vmatrix} \cdot \vec j
 + \begin{vmatrix}
 x_1 & y_1  \\
 x_2 & y_2 \\
 \end{vmatrix} \cdot \vec k
 \]
 \begin{align*}
 &= (y_1z_2 - z_1y_2) \vec{i} - (x_1z_2-z_1x_2) \vec{j} + (x_1y_2 - y_1x_2) \vec{k}\\
 &=(y_1z_2 - z_1y_2) \vec{i} + (z_1x_2 - x_1z_2) \vec{j} + (x_1y_2 - y_1x_2) \vec{k}
 \end{align*}
\[
 = \vec{v_1} \cross \vec{v_2}
\]
\end{proof}

\begin{example}[Example 1]
Let $\vec{v_1} = \vector{1,2,3}$ and $\vec{v_2} = \vector{4, 5, 6}$.  
Compute the cross product: $\vec{v_1} \cross \vec{v_2}$\\
\begin{align*}
\vec{v_1} \cross \vec{v_2} &= \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
1 & 2 & 3\\
4 & 5 & 6
\end{vmatrix}\\ 
&= \begin{vmatrix}
 2 & 3  \\
 5 & 6 \\
 \end{vmatrix} \cdot \vec i
 - \begin{vmatrix}
 1 & 3  \\
 4 & 6 \\
 \end{vmatrix} \cdot \vec j
 + \begin{vmatrix}
 1 & 2  \\
 4 & 5 \\
 \end{vmatrix} \cdot \vec k\\
 &= (12-15)\vec i - (6 - 12) \vec j + (5-8) \vec k\\
 &= -3\vec i + 6 \vec j -3 \vec k\\
 &= \vector{-3, 6, -3}
 \end{align*}
 \end{example}

\begin{problem}(Problem 1)
Let $\vec{v_1} = \vector{1,2,3}$ and $\vec{v_2} = \vector{4, 5, 6}$.\\  
Compute the cross product: 
\[
\vec{v_2} \cross \vec{v_1} = \vector{\answer{3}, \answer{-6}, \answer{3}}
\]
\end{problem}

\begin{proposition}[Orthogonality] 
Let  $\vec{v_1} = \vector{x_1, y_1, z_1}$ and $\vec{v_2} = \vector{x_2, y_2, z_2}$ be vectors in $\R^3$. 
The vector $\vec{v_1}\cross \vec{v_2}$ is orthogonal to both $\vec{v_1}$ and $\vec{v_2}$. 
\end{proposition}
\begin{proof} We will show that 
\[
 \vec{v_1} \dotp \left(\vec{v_1} \cross \vec{v_2} \right) = 0
\]
and leave it to the reader to show that
\[
\vec{v_2} \dotp \left(\vec{v_1} \cross \vec{v_2} \right) = 0
\]
We have:
\begin{align*}
\vec{v_1} \dotp \left(\vec{v_1} \cross \vec{v_2} \right)  
                            &= \vector{x_1, y_1, z_1}\dotp \vector{y_1z_2 - z_1y_2, z_1x_2 - x_1z_2, x_1y_2 - y_1x_2} \\
                                                &= x_1(y_1z_2 - z_1y_2) + y_1(z_1x_2 - x_1z_2) + z_1(x_1y_2 - y_1x_2)\\
                                                &= x_1y_1z_2 - x_1y_2z_1 + x_2y_1z_1 - x_1y_1z_2 + x_1y_2z_1 - x_2y_1z_1\\
                                                &= x_1y_1z_2 - x_1y_1z_2 + x_1y_2z_1 - x_1y_2z_1 + x_2y_1z_1 - x_2y_1z_1\\
                                                &= 0
\end{align*}
Hence, $\vec{v_1} \cross \vec{v_2}$ and $\vec{v_1}$ are orthogonal.  
The reader should perform a similar computation to verify that the vectors
$\vec{v_1} \cross \vec{v_2}$ and $\vec{v_2}$ are also orthogonal.
\end{proof}
In example 1, we found that
\[
\vector{1, 2, 3} \cross \vector{4, 5, 6} = \vector{-3, 6, -3}
\]
According to the above proposition, the vector $\vector{-3, 6, -3}$ should be orthogonal to both $\vector{1, 2, 3}$ and $\vector{4, 5, 6}$.
We can verify this using the dot product:
\[
\vector{1, 2, 3} \dotp \vector{-3, 6, -3} = (1)(-3) +(2)(6)+(3)(-3) = -3+12-9 = 0
\]
and
\[
\vector{4, 5, 6} \dotp \vector{-3, 6, -3} = (4)(-3) +(5)(6)+(6)(-3) = -12 + 30 -18 = 0
\]
Hence, the vector $\vector{-3, 6, -3}$ is orthogonal to each of the vectors $\vector{1, 2, 3}$ and $\vector{4, 5, 6}$ as claimed in the proposition.
Now we turn to a fact about parallel vectors.
Recall that parallel vectors are scalar multiples of each other.
\begin{proposition}[Parallel Vectors]
Let  $\vec{v_1} = \vector{x_1, y_1, z_1}$ and $\vec{v_2} = \vector{x_2, y_2, z_2}$ be vectors in $\R^3$.
If $\vec{v_1}$ and $\vec{v_2}$ are parallel then 
\[
\vec{v_1} \cross \vec{v_2} = \vec 0
\]
\end{proposition}
\begin{proof}
Since $\vec{v_1}$ and $\vec{v_2}$ are parallel, we can assume that there exists a scalar $`c'$ such that 
\[
\vec{v_2} = c\vec{v_1}
\]
Computing the cross product gives
\begin{align*}
\vec{v_1} \cross \vec{v_2} &= \vec{v_1} \cross c\vec{v_1}
                         =  \begin{vmatrix}
                                  \vec{i} & \vec{j} & \vec{k}\\
                                      x_1 & y_1 & z_1\\
                                       cx_1 & cy_1 & cz_1
                            \end{vmatrix} \\
&= \begin{vmatrix}
 y_1 & z_1  \\
 cy_1 & cz_1 \\
 \end{vmatrix} \cdot \vec i
 - \begin{vmatrix}
 x_1 & z_1  \\
 cx_1 & cz_1 \\
 \end{vmatrix} \cdot \vec j
 + \begin{vmatrix}
 x_1 & y_1  \\
 cx_1 & cy_1 \\
 \end{vmatrix} \cdot \vec k\\
 &= (y_1cz_1 - z_1cy_1) \vec{i} - (x_1cz_1-z_1cx_1) \vec{j} + (x_1cy_1 - y_1cx_1) \vec{k}\\
 &=0 \vec{i} + 0 \vec{j} + 0 \vec{k}\\
 &= \vec 0
 \end{align*}
 \end{proof}
Since any vector is parallel to itself, we have the following corollary.
\begin{corollary}
\[
\vec v \cross \vec v = \vec 0
\]
\end{corollary}

We now list some basic properties of the cross product.\\

\begin{enumerate}
\item The cross product is not commutative.  In fact, it is anti-commutative:
\[
\vec{v} \cross \vec{w} = -(\vec{w} \cross \vec{v})
\]
\item Scalars can factor out of a cross product:
\[
(c\vec{v}) \cross \vec{w} = c(\vec{v} \cross \vec{w})
\]
and
\[
\vec{v} \cross (c\vec{w}) = c(\vec{v} \cross \vec{w})
\]
\item The cross product distributes over vector addition 
(note that it is important to maintain the order of the vectors in the cross product due to its anticommutativity):
\[
\vec{u} \cross (\vec{v} + \vec{w}) = (\vec{u} \cross \vec{v}) + (\vec{u} \cross \vec{w})\quad \text{Left Distributive Property}
\]
and
\[
(\vec{u} + \vec{v}) \cross \vec{w} = (\vec{u} \cross \vec{w}) + (\vec{v} \cross \vec{w})\quad \text{Right Distributive Property}
\]
\end{enumerate}

Cross products of the standard basis vectors are useful:
\[
\vec{i} \cross \vec{j}=
 \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
1 & 0 & 0\\
0 & 1 & 0
\end{vmatrix}
= (0)\vec{i} - (0)\vec{j} + (1)\vec{k} = \vec{k}
\]
\[
\vec{j} \cross \vec{k}=
 \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
0 & 1 & 0\\
0 & 0 & 1
\end{vmatrix}
= (1)\vec{i} - (0)\vec{j} + (0)\vec{k} = \vec{i}
\]
and
\[
\vec{k} \cross \vec{i}=
 \begin{vmatrix}
\vec{i} & \vec{j} & \vec{k}\\
0 & 0 & 1\\
1 & 0 & 0
\end{vmatrix}
= (0)\vec{i} - (-1)\vec{j} + (1)\vec{k} = \vec{j}
\]
These results can be obtained with the aide of the following figure.
\begin{image}
\begin{tikzpicture}
%\draw (0,0) circle (3);
\node at (0,3.5){$\vec{i}$};
\node at (3.2,-1.2){$\vec{j}$};
\node at (-3.2,-1.2){$\vec{k}$};
\draw[-<] (3,0) arc (0:30:3);
\draw[-<] (3,0) arc (0:150:3);
\draw[-<] (3,0) arc (0:270:3);
\draw (3,0) arc (0:359.9:3);
\node at (0,1){$\vec{i} \cross \vec{j} = \vec{k}$};
\node at (0,0){$\vec{j} \cross \vec{k} = \vec{i}$};
\node at (0,-1){$\vec{k} \cross \vec{i} = \vec{j}$};
\node at (0, -3.5) {Follow the circle clockwise to compute the cross products};
\end{tikzpicture}
\end{image}

\begin{remark}
Since the cross product is anticommutative, the figure above yields the following additional results:
\begin{align*}
\vec{i} \cross \vec{k} &= \vec{-j}\\
\vec{k} \cross \vec{j} &= \vec{-i}\\
\vec{j} \cross \vec{i} &= \vec{-k}
\end{align*}
\end{remark}

\begin{example}[Example 2]
Compute the cross product: $(2\vec{i} - 3\vec{k}) \cross (\vec{j} + 4\vec{k})$.\\
Using the properties listed above and the results of the cross products involving the standard basis vectors, we have:
\begin{align*}
(2\vec{i} - 3\vec{k}) \cross (\vec{j} + 4\vec{k}) & = [(2\vec{i} - 3\vec{k}) \cross \vec{j}] + [(2\vec{i} - 3\vec{k}) \cross   4\vec{k}]\\
                                  &= (2\vec{i} \cross \vec{j}) + [(-3\vec{k}) \cross \vec{j})] +(2\vec{i} \cross   4\vec{k}) + [ (- 3\vec{k}) \cross   4\vec{k}]\\
                                  &= 2\vec{k} + 3 \vec{i} -8\vec{j} + \vec{0}\\
                                  &= 3\vec{i} - 8\vec{j} +2\vec{k}\\
                                  &= \vector{3, -8, 2}
\end{align*}
\end{example}

\begin{problem}(Problem 2)
Use the properties of the cross product to compute: 
\[
(\vec{i} + 2\vec{j}) \cross (3\vec{i} - \vec{k}) = \answer{\vector{-2,1,-6}}
\]
\end{problem}



The magnitude of a cross product is of great interest in applications.
\begin{proposition}
Let $\vec{v}$ and $\vec{w}$ be vectors in $\R^3$ (or $\R^2$). Then the magnitude of their cross product is given by
\[
|\vec{v} \cross \vec{w}| = |\vec{v}| \cdot |\vec{w}| \sin \theta
\]
where $\theta$ is the angle between $\vec{v}$ and $\vec{w}$.
\end{proposition}

Two vectors $\vec{v}$ and $\vec{w}$ generate a parallelogram and the area of this parallelogram is given by then magnitude of their cross product:
\[
A = |\vec{v} \cross \vec{w}|
\]

\begin{image}
\begin{tikzpicture}
\draw[blue, ->, thick] (0,0) -- (6, 0) node[below right]{$\vec{v}$};
\draw[red, ->, thick] (0,0) -- (4, 2) node[above left]{$\vec{w}$};
\draw[red, dashed, thin] (6,0) -- (10,2) ;
\draw[blue, dashed, thin] (4,2) -- (10,2) ;
\node at (5.5, -1){Parallelogram generated by $\vec{v}$ and $\vec{w}$ with area $A = |\vec{v} \cross \vec{w}|$};
\end{tikzpicture}
\end{image}

This can be used to find the area of a triangle with sides $\vec{v}, \vec{w}$ and $\vec{v}-\vec{w}$ since the area of this 
triangle is simple half of the area of the parallelogram generated by $\vec{v}$ and $\vec{w}$.

\begin{image}
\begin{tikzpicture}
\draw[blue, ->, thick] (0,0) -- (6, 0) node[midway, below]{$\vec{v}$};
\draw[red, ->, thick] (0,0) -- (4, 2) node[midway, above left]{$\vec{w}$};
\draw[brown!50!black, <-, thick] (6,0) -- (4,2) node[midway, above right]{$\vec{v}-\vec{w}$};
\node at (3, -1){Triangle with sides $\vec{v}, \vec{w}$ and $\vec{v} - \vec{w}$ with area $A = \frac12|\vec{v} \cross \vec{w}|$};
\end{tikzpicture}
\end{image}


Moreover, three vectors in $\R^3$ can generate a three dimensional analogue of a parallelogram. 
A parallelepiped is a three dimensional figure with 6 sides, each of which is a parallelogram.
The sides of these parallelograms can be determined using three vectors.
Given $\vec{u}, \vec{v}$ and $\vec{w}$
in $\R^3$ which generate a parallelepiped, the volume of this parallelepiped is given by
\[
V = |\vec{u} \dotp \left(\vec{v} \cross \vec{w}\right)|
\]


\begin{image}
\begin{tikzpicture}
\draw[blue, ->, thick] (0,0) -- (6, 0) node[midway, below]{$\vec{v}$};
\draw[brown!30!black, ->, thick] (0,0) -- (4, 2) node[midway, above left]{$\vec{w}$};
\draw[red, ->, thick] (0,0) -- (1, 5) node[midway, above left]{$\vec{u}$};
\draw[red, dashed, thin] (6,0) -- (7,5) (4,2)--(5,7) (10,2) -- (11,7);
\draw[blue, dashed, thin] (4,2) -- (10,2) (1,5) -- (7,5) (5,7) -- (11,7);
\draw[brown!30!black, dashed, thin] (6,0)--(10,2) (1,5)--(5,7) (7,5)--(11,7);
\node at (5.5, -1){Parallelepiped generated by $\vec{u}, \vec{v}$ and $\vec{w}$ with volume $V = |\vec{u} \dotp \left(\vec{v} \cross \vec{w}\right)|$};
\end{tikzpicture}
\end{image}



\end{document}


The tangent and Inverse tangent graphs

\begin{image}
\begin{tikzpicture}
\draw (-3, 0) -- (3, 0);
\draw (0, -4) -- (0,4);
\draw[blue, thick] (-0.15, -0.05) -- (0.15, 0.05);
\draw[dashed, thin, blue] (-2, -3.5) -- (-2, 3.5) (2, -3.5) -- (2, 3.5);
\draw[blue, thick, <-] (-1.95, -3.5) .. controls (-1.6,-2.3) and (-0.7,-0.3) ..  (-0.15, -0.05); %add control
\draw[blue, thick, <-] (1.95, 3.5) .. controls (1.6,2.3) and (0.7,0.3) .. (0.15, 0.05); %add control
\node[blue] at (-1, 1) {$y = \tan x$};
\end{tikzpicture}
\end{image}

\begin{image}
\begin{tikzpicture}
\draw (-4, 0) -- (4, 0);
\draw (0, -3) -- (0,3);
\draw[red, thick] (-0.05, -0.15) -- (0.05, 0.15);
\draw[dashed, thin, red] (-3.5, -2) -- (3.5,-2) (-3.5, 2) -- (3.5, 2);
\draw[red, thick, <-] (-3.5, -1.95) .. controls (-2.3, -1.6) and (-0.3, -0.7) ..  (-0.05, -0.15); %add control
\draw[red, thick, <-] (3.5, 1.95) .. controls (2.3, 1.6) and (0.3, 0.7) .. (0.05, 0.15); %add control
\node[red] at (1, -1) {$y = \tan^{-1}x$};
\end{tikzpicture}
\end{image}

\begin{image}
\begin{tikzpicture}
\draw (-4, 0) -- (4, 0);
\draw (0, -4) -- (0,4);
\draw[blue, thick] (-0.15, -0.05) -- (0.15, 0.05);
\draw[dashed, thin, blue] (-2, -4) -- (-2, -2.2) (2, 2.2) -- (2, 4);
\draw[blue, thick, <-] (-1.95, -3.5) .. controls (-1.6,-2.3) and (-0.7,-0.3) ..  (-0.15, -0.05); %add control
\draw[blue, thick, <-] (1.95, 3.5) .. controls (1.6,2.3) and (0.7,0.3) .. (0.15, 0.05); %add control
\node[blue] at (1, 3) {$y = \tan x$};

\draw[red, thick] (-0.05, -0.15) -- (0.05, 0.15);
\draw[dashed, thin, red] (-4, -2) -- (-2.2,-2) (2.2, 2) -- (4, 2);
\draw[red, thick, <-] (-3.5, -1.95) .. controls (-2.3, -1.6) and (-0.3, -0.7) ..  (-0.05, -0.15); %add control
\draw[red, thick, <-] (3.5, 1.95) .. controls (2.3, 1.6) and (0.3, 0.7) .. (0.05, 0.15); %add control
\node[red] at (3, 1.3) {$y = \tan^{-1}x$};

%add hash marks to axes
\end{tikzpicture}
\end{image}

\begin{tikzpicture} 
\draw[help lines] (0,0) grid (8,3); \draw    (1,0)      .. controls (4,2) ..    (7,0);   
\end{tikzpicture}  

\begin{tikzpicture} 
\draw[help lines] (0,0) grid (8,3); \draw    (1,0)      .. controls (3,2) and (5,2) ..    (7,0);   
\end{tikzpicture} 
 
\begin{tikzpicture} \draw[help lines] (0,0) grid (8,3); \draw[overlay]    (1,0)      .. controls (10,2) and (-2,2) ..    (7,0);   
\end{tikzpicture}  
\begin{tikzpicture} \draw[help lines] (0,-1) grid (8,1); \draw    (1,0)      .. controls (3,2) and (5,-2) ..    (7,0);   
\end{tikzpicture} 





\begin{tikzpicture}
\draw (0,0) % [show curve controls] (0, 0) 
  .. controls ++(165:-1) and ++(240: 1) .. ( 3, 2)
  .. controls ++(240:-1) and ++(165:-1) .. ( 2, 4)
  .. controls ++(165: 1) and ++(175:-2) .. (-1, 2)
  .. controls ++(175: 2) and ++(165: 1) .. ( 0, 0);
\end{tikzpicture}

\begin{tikzpicture}
\draw (0,0) % [show curve controls] (0, 0) 
  .. controls ++(180:-1) and ++(270: 1) .. ( 2, 2)
  .. controls ++(90:1) and ++(180:-1) .. ( 0, 4)
  .. controls ++(180: 1) and ++(270:-1) .. (-2, 2)
  .. controls ++(270: 1) and ++(180: 1) .. ( 0, 0);
\end{tikzpicture}


\tikzset{
  show curve controls/.style={
    decoration={
      show path construction,
      curveto code={
        \draw[#1!50]
        (\tikzinputsegmentfirst)
        -- (\tikzinputsegmentsupporta)
        -- (\tikzinputsegmentsupportb)
        -- (\tikzinputsegmentlast)
        ;
        \fill[#1!50] (\tikzinputsegmentsupporta) circle(1pt);
        \fill[#1!50] (\tikzinputsegmentsupportb) circle(1pt);
        \draw[#1,line width=1pt]
        (\tikzinputsegmentfirst)
        .. controls (\tikzinputsegmentsupporta)
                and (\tikzinputsegmentsupportb) ..
        (\tikzinputsegmentlast);
      }
    },decorate
  }
}


\foreach \p in {0,10,...,360} {
  \begin{tikzpicture}
    \begin{scope}
      \path (-4,-2) rectangle (4,2.1);
      \coordinate (a) at (-2,0);
      \coordinate (b) at (2,0);
      \path (a) ++(1,0) ++(\p:0 and 2) coordinate (a1);
      \path (b) ++(-1,0) ++({180-\p}:0 and 2) coordinate (b1);
      \draw[show curve controls={red}] (a) .. controls (a1) and (b1) .. (b);
    \end{scope}
    \begin{scope}[yshift=-4.5cm]
      \path (-4,-1) rectangle (4,4);
      \coordinate (a) at (-2,0);
      \coordinate (b) at (2,0);
      \path (a) ++(45:3) ++(\p:3 and 0) coordinate (a1);
      \path (b) ++(90+45:3) ++(180-\p:3 and 0) coordinate (b1);
      \draw[show curve controls={blue}] (a) .. controls (a1) and (b1) .. (b);
    \end{scope}
    \begin{scope}[yshift=-6cm]
      \path (-4,-3) rectangle (4,4);
      \coordinate (a) at (-2,0);
      \coordinate (b) at (2,0);
      \path (a) ++(1,0) [rotate=45] ++(\p:0 and 2) coordinate (a1);
      \path (b) ++(-1,0) [rotate=45] ++({180+\p}:0 and 2) coordinate (b1);
      \draw[show curve controls={green!50!black}]
        (a) .. controls (a1) and (b1) .. (b);
    \end{scope}
    \begin{pgfonlayer}{background}
      \fill[white] (current bounding box.south west)
         rectangle (current bounding box.north east);
    \end{pgfonlayer}
  \end{tikzpicture}
}


