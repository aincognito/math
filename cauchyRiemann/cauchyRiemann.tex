\documentclass[handout]{ximera}

\input{../preamble}

\pgfplotsset{compat=1.13}

\outcome{Derive the Cauchy-Riemann equations}

\title{3.3 Cauchy-Riemann Equations}

\begin{document}

\begin{abstract}
We derive the Cauchy-Riemann equations.
\end{abstract}

\maketitle

Recall the definition of partial derivative from multi-variable calculus.  
Let $u(x,y)$ be defined in a neighborhood of $(x_0,y_0)$, then its partial derivatives are defined by

\[
u_x(x_0, y_0) = \frac{\partial u}{\partial x}\Bigg|_{(x_0,y_0)} = \lim_{h \to 0} \frac{u(x_0 +h, y_0) - u(x_0,y_0)}{h}
\]

and

\[
u_y(x_0, y_0) = \frac{\partial u}{\partial y}\Bigg|_{(x_0,y_0)} = \lim_{h \to 0} \frac{u(x_0 , y_0+h) - u(x_0,y_0)}{h}
\]

In the definition of $f'(z_0)$ we can let $h$ approach $0$ along any path. If we choose $h$ to be real, then we get a powerful result.

\begin{theorem}
If $f(z) = u(x,y) + iv(x,y)$ is differentiable at $z_0 = x_0 + iy_0$, then
\[
f'(z_0) = u_x(x_0,y_0) + iv_x(x_0,y_0)
\]
\end{theorem}

\begin{remark}
In short, we can write
\[
f' = f_x = u_x + iv_x
\]
\end{remark}

\begin{proof}
We let $h$ approach $0$ along the $x$-axis in the definition of $f'(z_0)$:
\begin{align*}
f'(z_0) &= \lim_{h \to 0 \atop h \in \R} \frac{f(z_0 + h) -f(z_0)}{h} \\[10pt]
        &= \lim_{h \to 0} \frac{\left[u(x_0 +h, y_0) + iv(x_0 +h, y_0)\right] - \left[u(x_0,y_0)+iv(x_0, y_0)\right]}{h} \\[10pt]
        &=  \lim_{h \to 0} \frac{u(x_0 +h, y_0)- u(x_0,y_0)}{h} +i\lim_{h \to 0}\frac{v(x_0 +h, y_0)-v(x_0, y_0)}{h} \\[10pt]
        &= u_x(x_0,y_0) + iv_x(x_0,y_0)
\end{align*}
\end{proof}


\begin{example}[example 1]
Find $f'(z)$ for the complex exponential function $f(z) = e^z$.\\
Assuming that $e^z$ is a differentiable function of $z$, then since $e^z = e^x \cos y + i e^x \sin y$, we have
\[
u_x = u_x(x,y) = \frac{\partial}{\partial x} \left(e^x \cos y \right)= e^x \cos y 
\]
and
\[
 v_x = v_x(x,y) = \frac{\partial}{\partial x}\left(e^x \sin y\right) = e^x \sin y
\]
Thus, if it exists, 
\[
f'(z_0) = e^{x_0} \cos y_0 + i e^{x_0} \sin y_0  = e^{z_0}
\]
for any $z_0 = x_0 + iy_0 \in \C$.
Hence, if $e^z$ is differentiable, its derivative would be
\[
\frac{d}{dz} e^z = e^z \;\; \mbox{for all} \;\; z \in \C
\]
\end{example}


\begin{problem}(problem 1a)
Assuming that the complex sine and cosine are differentiable functions of $z$, show that
\[
\frac{d}{dz} \sin z = \cos z \quad \mbox{and} \quad \frac{d}{dz} \cos z = -\sin z
\]
for all $z \in \C$.
\begin{hint}
$\sin z = \sin x \cosh y + i \cos x \sinh y$
\end{hint}
\begin{hint}
$\cos z = \cos x \cosh y - i \sin x \sinh y$
\end{hint}
\end{problem}

Here is a video solution to problem 1a:\\
\begin{foldable}
\youtube{yqRxBdxhuug}
\end{foldable}

In the theorem above, we computed $f'(z_0)$ by letting $h$ be real.  
Suppose we let $h$ be purely imaginary, instead.
Let $h = ik$ where $k \in \R$, then
\begin{align*}
f'(z_0) &= \lim_{h \to 0 \atop h = ik} \frac{f(z_0 + h) -f(z_0)}{h} \\[10pt]
        &= \lim_{k \to 0 \atop k \in \R} \frac{\left[u(x_0 , y_0+k) + iv(x_0 , y_0+k)\right] -
         \left[u(x_0,y_0)+iv(x_0, y_0)\right]}{ik} \\[10pt]
        &=  \lim_{k \to 0} \frac{u(x_0 , y_0+k)- u(x_0,y_0)}{ik} +
        i\lim_{k \to 0}\frac{v(x_0 , y_0+k)-v(x_0, y_0)}{ik} \\[10pt]
        &= -iu_y(x_0,y_0) + v_y(x_0,y_0)\\
        &=  v_y(x_0,y_0)-iu_y(x_0,y_0)
\end{align*}

Thus we see that we could have written $f'$ as
\[
f'(z_0) = v_y(x_0,y_0)-iu_y(x_0,y_0)
\]

Now, we have two different forms for $f'(z_0)$ which depend on the direction in which $h$ approached $0$.
By assumption, $f$ was differentiable at $z_0$, so these two forms must be equal. 
This gives rise to the Cauchy-Riemann equations.


\begin{theorem}[Cauchy-Riemann Equations]
Suppose $f(z)$ is differentiable at $z = z_0 = x_0 +iy_0$. Then
\[
v_x(x_0,y_0)= -u_y(x_0,y_0) 
\]
and 
\[
v_y(x_0,y_0) = u_x(x_0,y_0)
\]
In short, 
\[
u_x =v_y \quad \mbox{and} \quad u_y = -v_x
\]
\end{theorem}


\begin{proof}
Since $f$ is differentiable at $z_0$, we can let $h$ be either purely real or 
purely imaginary in the definition of $f'(z_0)$
and the results must be equal. Therefore
\[
f'(z_0) = u_x(x_0,y_0)+iv_x(x_0,y_0)
\]
and
\[
f'(z_0) = v_y(x_0,y_0)-iu_y(x_0,y_0)
\]
The result follows by equating the real and imaginary parts.
\end{proof}
\begin{remark}
The Cauchy-Riemann equations can be written in a single complex equation instead of two real equations as
\[
f_y = if_x
\]
\end{remark}

Some functions, like $\Log z$ and $z^{1/2}$, are best described using polar coordinates. 
To determine their derivatives, we need 
to express $f'(z)$ in terms of $u_r, u_\theta, v_r$ and $v_\theta$. 
To do this, we will take advantage of the polar coordinate transformations,
\[
x = r\cos \theta \quad \mbox{and} \quad y=r\sin \theta
\]
and the multivariate version of the chain rule.
Suppose $f(z) = u(x,y) + iv(x,y)$ is differentiable at $z = x+iy$.
Then, by the multivariate chain rule,
\begin{align*}
\frac{\partial u}{\partial r} &= \frac{\partial u}{\partial x}\frac{\partial x}{\partial r}+\frac{\partial u}{\partial y}\frac{\partial y}{\partial r}\\
                              &= \frac{\partial u}{\partial x} \cos\theta + \frac{\partial u}{\partial y} \sin \theta
\end{align*}
In short,
\[
u_r = u_x \cos \theta + u_y \sin\theta
\]


\begin{problem}(problem 1b, chain rule)
Show that
\[
u_\theta = -ru_x \sin \theta + ru_y \cos\theta
\]
\end{problem}

Here is a video solution to problem 1b:\\
\begin{foldable}
\youtube{2f31h_zGQD0}
\end{foldable}

Similarly,
\[
 v_r = v_x \cos \theta + v_y \sin\theta \quad \mbox{and} \quad  v_\theta = -rv_x \sin \theta + rv_y \cos\theta
\]

By the Cauchy-Riemann equations, $u_x = v_y$ and $u_y = -v_x$ we have
%and substituting for $v_x$ and $v_y$ in $v_r$ and $v_\theta$ from the problem above, gives
\[
v_r = -u_y \cos \theta + u_x \sin\theta \quad \mbox{and} \quad  v_\theta = ru_y \sin \theta + ru_x \cos\theta
\]
Now, we can observe the Cauchy-Riemann equations in polar form:
\[
u_r = \frac{1}{r} v_\theta \quad \mbox{and} \quad u_\theta = -rv_r
\]
Finally, we would like to formulate $f'(z) = u_x + iv_x$, in terms of $u_r$ and $v_r$.


\begin{problem}(problem 1c, linear system)
 Solve the $2 \times 2$ system of equations
\begin{align*}
u_r &= u_x \cos \theta + u_y \sin\theta\\
v_r &= u_x \sin \theta -u_y \cos\theta
\end{align*}
for $u_x$ and $u_y$
\begin{multipleChoice}
\choice{$u_x = u_r \cos \theta - v_r \sin \theta$ \quad and \quad $u_y = u_r \sin \theta + v_r \cos \theta $}
\choice{$u_x = u_r \sin \theta + v_r \cos \theta$ \quad and \quad $u_y = u_r \cos \theta - v_r \sin \theta $}
\choice[correct]{$u_x = u_r \cos \theta + v_r \sin \theta$ \quad and \quad $u_y = u_r \sin \theta - v_r \cos \theta $}
\end{multipleChoice}
\end{problem}

Here is a video solution to problem 1c:\\
\begin{foldable}
\youtube{dGrS9h2QKS4}
\end{foldable}


From the Cauchy-Riemann equation, $v_x = -u_y$, and the result of the previous problem, we can write
\begin{align*}
f'(z) &= u_x + iv_x\\
      & = u_x - iu_y\\
      &= \left[u_r \cos \theta + v_r \sin \theta\right] - i\left[ u_r \sin \theta - v_r \cos \theta \right]\\
      &= \left[u_r \cos \theta -i u_r \sin \theta\right] + i\left[ v_r \cos \theta  - iv_r \sin \theta\right]\\
      &= u_r e^{-i\theta} + iv_r e^{-i\theta}\\
      &=  e^{-i\theta}(u_r +iv_r)
\end{align*}

We have just proved the following theorem:

\begin{theorem}
If $f(z) = f\left(re^{i\theta}\right)$ is differentiable at $z = z_0 = r_0 e^{i\theta_0}$ then
\[
f'(z_0) = e^{-i\theta_0} \left[u_r(r_0, \theta_0) + iv_r(r_0, \theta_0)\right]
\]
\end{theorem}

\begin{example}[example 2]
Assuming that it exists, use the theorem above to find the derivative of $f(z) = \Log z$ 
at $z = z_0$ where $z_0$ is in the 
slit plane $\C \backslash \{x\leq 0, y=0\}$ \\
We can write $z_0 = r_0 e^{i\theta_0}$ where $\theta_0 = \Arg z_0$. Since $\Log z = \ln r + i\theta$
where $\theta = \Arg z$, we have 
\[
u_r(r_0,\theta_0) = \frac{1}{r_0} \quad \mbox{and} \quad v_r(r_0,\theta_0) = 0
\]
Hence, according to the theorem,
\begin{align*}
f'(z_0) &= e^{-i\theta_0}[u_r(r_0,\theta_0)+iv_r(r_0,\theta_0)] \\
        &= e^{-i\theta_0}\frac{1}{r_0}\\
        &= \frac{1}{e^{i\theta_0}r_0}\\
        &= \frac{1}{z_0}
\end{align*}
Dropping the subscript, we can write
\[
\frac{d}{dz} \Log z = \frac{1}{z}
\]
for $z$ in the slit plane.
\end{example}

\begin{problem}(problem 2)
Let $z_0$ be in the slit plane, $\C \backslash \{x\leq 0, y=0\}$. 
Assuming the derivative exists, find $f'(z_0)$ if $f(z) = z^{1/2}$, 
the principal branch of the square root function.
\begin{hint}
$\displaystyle z^{\frac12} = r^{\frac12}e^{i\frac{\theta}{2}}$ where $\theta = \Arg z$
\end{hint}
\end{problem}

Here is a video solution to problem 2:\\
\begin{foldable}
\youtube{XkMEXxfp7oY}
\end{foldable}

The Cauchy-Riemann equations tell us that if $f$ is a differentiable function of $z$, 
then it must satisfy $f_x = -if_y$.
There is also a partial converse to this statement.  

\begin{theorem}
Let $f(z) = u(x,y) + iv(x,y)$ and suppose the partial derivatives $u_x, u_y, v_x$ and $v_y$ are 
continuous at $(x_0,y_0)$ and 
 satisfy the Cauchy-Riemann equations there. Then $f(z)$
is differentiable at $z_0 = x_0 + iy_0$.
\end{theorem}

\begin{proof}
For ease of readability, we will drop the subscripts on the point $(x_0,y_0)$.\\
Let $h$ and $k$ both be real numbers and consider the following limit:
\[
L = \lim_{h+ik \to 0} \frac{u(x+h, y+k) - u(x,y)}{h+ik} 
\]
In a standard partial derivative, one of $h$ or $k$ would be zero. 
Our goal is to turn this limit into partial derivatives,
and will do so with the aid of the Mean Value Theorem. Recall that the MVT states that 
if $g$ is a differentiable function (of a single variable), then for some number $c$ between $a$ and $b$
\[
g(b) -g(a) = g'(c)(b-a)
\]
To apply the theorem, we   
we will add and subtract the term $u(x,y+k)$ in the numerator of the above limit.
This leads to 
\[
L = \lim_{h+ik \to 0} \frac{u(x+h, y+k) - u(x,y+k)}{h+ik} + 
\lim_{h+ik \to 0} \frac{u(x, y+k) - u(x,y)}{h+ik} =  L_1 + L_2 
\]
The limits $L_1$ and $L_2$ will be dealt with similarly, so let's focus on $L_1$ and apply the MVT, 
considering $u$ to be a function of a single variable (since the second component is constant). We have
\[
L_1 = \lim_{h+ik \to 0} \frac{u(x+h, y+k) - u(x,y+k)}{h+ik} = \lim_{h+ik \to 0} \frac{u_x(x^*,y+k)h}{h+ik}
\]
where $x^*$ is between $x$ and $x+h$. In order to take advantage of the continuity of $u_x$  at 
the point $(x,y)$, 
we add and subtract $u_x(x,y)$ in the numerator and split $L_1$ into two limits:
\[
L_1 = \lim_{h+ik \to 0} \frac{u_x(x,y)h}{h+ik} + 
\lim_{h+ik \to 0} \frac{[u_x(x^*,y+k)-u_x(x,y)]h}{h+ik}= L_{1a} + L_{1b}
\]
In the limit $L_{1b}$, note that $\left|\frac{h}{h+ik}\right| \leq 1$, hence
 
\[
0\leq \left|\frac{[u_x(x^*,y+k)-u_x(x,y)]h}{h+ik}\right| \leq \left|u_x(x^*,y+k)-u_x(x,y)\right|
\]
Now, the continuity of $u_x$ at $(x,y)$ gives
\[
\lim_{h+ik \to 0} \left[u_x(x^*,y+k)-u_x(x,y)\right] =0
\]
which implies that
\[
\lim_{h+ik \to 0} \left|u_x(x^*,y+k)-u_x(x,y)\right| =0
\]
Finally, the Squeeze Theorem gives $L_{1b} = 0$ and so
\[
L_1 = L_{1a} = \lim_{h+ik \to 0} \frac{u_x(x,y)h}{h+ik}
\]
Performing a similar analysis on $L_2$ yields
 \[
L_2 = \lim_{h+ik \to 0} \frac{u_y(x,y)k}{h+ik}
\]
Moreover, since $f(x+iy) = u(x,y) + iv(x,y)$, we can treat $v$ in the exact same way to obtain:
\[
\lim_{h+ik \to 0} \frac{v(x+h, y+k) - u(x,y)}{h+ik} =  L_3 + L_4 
\]
where
\[
L_3 = \lim_{h+ik \to 0} \frac{v_x(x,y)h}{h+ik}
\]
and
 \[
L_4 = \lim_{h+ik \to 0} \frac{v_y(x,y)k}{h+ik}
\]
Now we use the hypotheses that $u$ and $v$ satisfy the Cauchy-Riemann equations to rewrite $L_2$ and $L_4$ as
\[
L_4 = -i^2\lim_{h+ik \to 0} \frac{v_y(x,y)k}{h+ik} = -i\lim_{h+ik \to 0} \frac{u_x(x,y)ik}{h+ik}
\]
and 
\[
L_2 = -i^2\lim_{h+ik \to 0} \frac{u_y(x,y)k}{h+ik} = i\lim_{h+ik \to 0} \frac{v_x(x,y)ik}{h+ik}
\]
We can now readily obtain the result.
\begin{align*}
f'(z) &= \lim_{h+ik \to 0} {f(z+h+ik)-f(z)}{h+ik}\\[8pt]
      &=\lim_{h+ik \to 0} \frac{\left[u(x+h, y+k) +iv(x+h, y+k)\right] - \left[u(x,y) + iv(x,y)\right]}{h+ik} \\[8pt]
      &=\lim_{h+ik \to 0} \frac{u(x+h, y+k) - u(x,y)}{h+ik} +
      i\lim_{h+ik \to 0} \frac{v(x+h, y+k) - v(x,y)}{h+ik} \\[8pt]
      &= L_1+L2+ i(L_3 + L_4)\\[8pt]
      &= ( L_1+  iL_4) +(L2+ iL_3 )\\[8pt]
      &= \lim_{h+ik \to 0}\frac{u_x(x,y)(h+ik)}{h+ik} + i\lim_{h+ik \to 0}\frac{v_x(x,y)(h+ik)}{h+ik}\\[8pt]
      &= u_x(x,y) + iv_x(x,y)
\end{align*}
Hence $f$ is differentiable at $z$.
\end{proof}


\begin{example}[example 3]
Show that the function $f(z) = \overline{z}^2$ is differentiable at $z = 0$ and nowhere else.\\
The real and imaginary parts of $f$ are
\[
u = x^2 - y^2 \quad \text{and} \quad v= -2xy
\]
Their partial derivatives are
\[
u_x = 2x, \;u_y = -2y,\; v_x = -2y, \; \text{and} \;\; v_y =-2x
\]
The partials are continuous on $\R^2$ but the Cauchy-Riemann equations are only satisfied at $(0,0)$ since
\[
u_x = v_y \Rightarrow 2x = -2x \Rightarrow x=0
\]
and
\[
u_y = -v_x \Rightarrow -2y = 2y \Rightarrow y=0
\]

\end{example}


\begin{problem}(problem 3)
Where are the following functions differentiable?

\begin{hint}
(Part i) $f$ is nowhere differentiable since $u_x \neq v_y$ at any point $(x_0, y_0)$
\end{hint}
\begin{hint}
(Part ii)$u_x = v_y$ implies $\cos y =0$
\end{hint}
\begin{hint}
(Part ii)$u_y = -v_x$ implies $\sin y =0$
\end{hint}
\begin{hint}
(Part ii)$f$ is nowhere differentiable since these equations are never satified simultaneously
\end{hint}
\begin{hint}
(Part iv)$f$ is differentiable at the points $(\frac{\pi}{2} +k\pi, 0)$
\end{hint}
\begin{align*}
i) \;\; & f(z) = \overline{z} \\
& u_x = \answer{1} \quad u_y = \answer{0} \\
& v_x = \answer{0} \quad v_y = \answer{-1} \\
ii) \;\; & f(z) = e^{\overline{z}} \\
& u_x = \answer{e^x \cos y} \quad u_y = \answer{-e^x \sin y} \\
& v_x = \answer{-e^x \sin y} \quad v_y = \answer{-e^x \cos y} \\
iii) \;\; & f(z) = \frac{x+iy}{x^2 + y^2} \\
& u_x = \answer{\frac{y^2 -x^2}{(x^2 +y^2)^2}} \quad u_y = \answer{\frac{-2xy}{(x^2 +y^2)^2}}\\
& v_x = \answer{\frac{-2xy}{(x^2 +y^2)^2}} \quad v_y = \answer{\frac{x^2 - y^2}{(x^2 +y^2)^2}} \\
iv) \;\; & f(z) = \sin x \cosh y - i \cos x \sinh y \\
& u_x = \answer{\cos x \cosh y} \quad u_y = \answer{\sin x \sinh y} \\ 
& v_x = \answer{\sin x \sinh y} \quad v_y = \answer{-\cos x \cosh y} 
\end{align*}
\end{problem}

Here is a video solution to problem 3, part iii:\\
\begin{foldable}
\youtube{tv9JcH6hQqg}
\end{foldable}

\end{document}



